From: <Saved by UnMHT>
Subject: =?iso-2022-jp?B?U2hhcnAgVGVzdHMgRXg=?=
Date: Sun, Mar 18 2012 07:40:44 GMT+0100
MIME-Version: 1.0
Content-Type: multipart/related;
	boundary="----=_NextPart_000_0000_A5779167.B5ED4A03";
	type="text/html"

------=_NextPart_000_0000_A5779167.B5ED4A03
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://sharptestex.codeplex.com/wikipage?title=AssertionActions&referringTitle=Documentation

=EF=BB=BF<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "ht=
tp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class=3D"FF " xmlns=3D"http://www.w3.org/1999/xhtml"><head id=3D"ctl0=
0_ctl00_HeadTag"><meta http-equiv=3D"Content-Type" content=3D"text/html; ch=
arset=3Dutf-8"><script src=3D"http://s1.lqcdn.com/m.min.js"></script><link=
 href=3D"http://i1.codeplex.com/css/v18613/i70663/StyleSheet.ashx" rel=3D"s=
tylesheet" type=3D"text/css" id=3D"ctl00_ctl00_MasterCss"></link><link href=
=3D"favicon.ico" rel=3D"SHORTCUT ICON"></link>
    <style type=3D"text/css">.SideBar, .SideBarPadding{display:none;}.MainC=
ontent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style type=3D"text/css" id=3D"ctl00_ctl00_Header_ProjectStyles">.SiteH=
eader,.SiteHeaderLeft{height:45px !important;overflow:hidden;}.SiteContent{=
padding:0 0 1em 0;margin-top:0;min-height:225px;border-right:1px solid ligh=
tgrey;border-left:1px solid lightgrey;border-bottom:1px solid lightgrey;}.F=
F .SiteContentTable{clear:both;}.ProjectContent{min-height:225px;}.Safari=
 .ProjectContent{padding-top:0em;}.IE6 .ProjectTitleControl{position:relati=
ve;}.CanvasMargin{width:0;}h1.ProjectHeader{font-size:2em;font-weight:bold;=
margin-bottom:0;}.ProjectHeader a{color:#3E62A6;}.IE table.MinWidthContent{=
table-layout:auto !important;}.ProjectMessage{border:solid 0.1em #ccc;backg=
round-color:#F1FCEE;padding:1em;}</style>
   =20
   =20
   =20
   =20
   =20
   =20
    <style type=3D"text/css">.ProjectContent{padding:0;}</style>
    <style type=3D"text/css">
        .WikiHolder
        {
            margin: 0 1em 0 1em;
            width: 636px;
            overflow: hidden;
        }
        #WikiBreadCrumbs
        {
            margin: 0.25em 0 1em 0;
        }
        .SecondarySearchButton=20
        {
            margin:0 0 0 -0.6em;
        }
        .FF .SecondarySearchButton=20
        {
            margin:-0.1em 0 0 -0.5em;
            height: 22px;
        }
        .IE .SecondarySearchButton
        {
            width: 22px;
            height: 22px;
        }
    </style>
   =20
   =20
    <meta content=3D"sharptestsex" name=3D"WT.pi" id=3D"ctl00_ctl00_Header_=
WTProjectName">
    <link href=3D"http://sharptestex.codeplex.com/rsd" title=3D"RSD" type=
=3D"application/rsd+xml" rel=3D"EditURI"></link>
    <link href=3D"/wlwmanifest.xml" title=3D"WLWManifest" type=3D"applicati=
on/wlwmanifest+xml" rel=3D"wlwmanifest"></link>
<meta name=3D"Description" id=3D"ctl00_ctl00_PageDescription"><link href=3D=
"http://sharptestex.codeplex.com/project/feeds/rss" title=3D"Sharp Tests Ex=
" type=3D"application/rss+xml" rel=3D"alternate"></link><link href=3D"http:=
//sharptestex.codeplex.com/project/feeds/rss?ProjectRSSFeed=3Dcodeplex%3a%2=
f%2fforum%2fsharptestex" title=3D"Sharp Tests Ex-Discussions" type=3D"appli=
cation/rss+xml" rel=3D"alternate"></link><link href=3D"http://sharptestex.c=
odeplex.com/project/feeds/rss?ProjectRSSFeed=3Dcodeplex%3a%2f%2fworkitem%2f=
sharptestex" title=3D"Sharp Tests Ex-Issue Tracker" type=3D"application/rss=
+xml" rel=3D"alternate"></link><link href=3D"http://sharptestex.codeplex.co=
m/project/feeds/rss?ProjectRSSFeed=3Dcodeplex%3a%2f%2frelease%2fsharptestex=
" title=3D"Sharp Tests Ex-Releases" type=3D"application/rss+xml" rel=3D"alt=
ernate"></link><link href=3D"http://sharptestex.codeplex.com/project/feeds/=
rss?ProjectRSSFeed=3Dcodeplex%3a%2f%2fsourcecontrol%2fsharptestex" title=3D=
"Sharp Tests Ex-Source Code" type=3D"application/rss+xml" rel=3D"alternate"=
></link><link href=3D"http://sharptestex.codeplex.com/project/feeds/rss?Pro=
jectRSSFeed=3Dcodeplex%3a%2f%2fwiki%2fsharptestex" title=3D"Sharp Tests Ex-=
Wiki" type=3D"application/rss+xml" rel=3D"alternate"></link><link href=3D"h=
ttp://sharptestex.codeplex.com/project/feeds/rss?ProjectRSSFeed=3Dcodeplex%=
3a%2f%2freview%2fsharptestex" title=3D"Sharp Tests Ex-Reviews" type=3D"appl=
ication/rss+xml" rel=3D"alternate"></link><title>
	Sharp Tests Ex
</title><base href=3D"http://sharptestex.codeplex.com/"></base></head><body=
 onload=3D"masterLoad();" __vsttwindowid=3D"1332052004246"><form enctype=3D=
"multipart/form-data" autocomplete=3D"off" id=3D"aspnetForm" action=3D"/wik=
ipage?title=3DAssertionActions&amp;referringTitle=3DDocumentation" method=
=3D"POST" name=3D"aspnetForm"><table cellspacing=3D"0" cellpadding=3D"0" id=
=3D"CanvasTable"><tbody><tr valign=3D"top"><td><div id=3D"Canvas"><div id=
=3D"CanvasContent"><div><div class=3D"SiteContent FixedWidth ProjectBackgro=
und" id=3D"ctl00_ctl00_MasterContent_ProjectBody"><table cellspacing=3D"0"=
 cellpadding=3D"0" class=3D"SiteContentTable"><tbody><tr valign=3D"top"><td=
 class=3D"MainContent"><div class=3D"MainContentMinWidthContent"><div class=
=3D"ProjectContent" id=3D"ctl00_ctl00_MasterContent_ProjectContentPanel"><t=
able width=3D"100%" cellspacing=3D"0" cellpadding=3D"0"><tbody><tr><td vali=
gn=3D"top"><div class=3D"Content" id=3D"ctl00_ctl00_MasterContent_ContentPa=
nel"><div class=3D"WikiHolder"><div class=3D"WikiContent" id=3D"WikiContent=
"><div class=3D"wikidoc"><h2>Actions Assertions</h2>
The assertions over <span class=3D"codeInline">Action</span> is basically=
 to check a possible <span class=3D"codeInline">Exception</span> executing=
 the <span class=3D"codeInline">Action</span>.<br><div style=3D"color:Black=
;background-color:White;"><pre>			(<span style=3D"color:Blue;">new</span>=
 Action(() =3D&gt; <span style=3D"color:Blue;">new</span> AClass(<span styl=
e=3D"color:Blue;">null</span>))).Should().Throw(); <span style=3D"color:Gre=
en;">// for no specific exception type</span>
			(<span style=3D"color:Blue;">new</span> Action(() =3D&gt; <span style=3D=
"color:Blue;">new</span> AClass(<span style=3D"color:Blue;">null</span>))).=
Should().Throw&lt;ArgumentNullException&gt;();
			(<span style=3D"color:Blue;">new</span> Action(() =3D&gt; <span style=3D=
"color:Blue;">new</span> AClass(<span style=3D"color:#A31515;">&quot;valid=
 parameter&quot;</span>))).Should().NotThrow();
</pre></div><br>The <span class=3D"codeInline">.Should().Throw</span> allow=
 <i>chain</i> and the <a href=3D"http://sharptestex.codeplex.com/wikipage?t=
itle=3DSyntaxMainPage&amp;referringTitle=3DAssertionActions&amp;ANCHOR#Valu=
eOf">ValueOf</a> come in play again.<br><div style=3D"color:Black;backgroun=
d-color:White;"><pre>			(<span style=3D"color:Blue;">new</span> Action(()=
 =3D&gt; <span style=3D"color:Blue;">new</span> AClass(<span style=3D"color=
:Blue;">null</span>)))
				.Should().Throw&lt;ArgumentNullException&gt;()
				.And.
				ValueOf.ParamName
					.Should().Be.EqualTo(<span style=3D"color:#A31515;">&quot;obj&quot;</s=
pan>);
</pre></div><br>To avoid the creation of a <span class=3D"codeInline">new=
 Action</span> <b>Sharp Tests Ex</b> has a <u>static</u> class <a href=3D"h=
ttp://sharptestex.codeplex.com/wikipage?title=3DAssertionStatic&amp;referri=
ngTitle=3DAssertionActions">Executing</a> so you can use even the follow sy=
ntax:<br><div style=3D"color:Black;background-color:White;"><pre>			Executi=
ng.This(() =3D&gt; <span style=3D"color:Blue;">new</span> AClass(<span styl=
e=3D"color:Blue;">null</span>)).Should().Throw&lt;ArgumentNullException&gt;=
()
				.And.ValueOf.ParamName.Should().Be.EqualTo(<span style=3D"color:#A31515=
;">&quot;obj&quot;</span>);
</pre></div>or<br><div style=3D"color:Black;background-color:White;"><pre>=
			Executing.This(() =3D&gt; <span style=3D"color:Blue;">new</span> AClass(=
<span style=3D"color:Blue;">null</span>)).Should().Throw()
				.And.Exception.Should().Be.InstanceOf&lt;ArgumentException&gt;();
</pre></div>
<h4>The Executing extension</h4>
The usage of the static class <a href=3D"http://sharptestex.codeplex.com/wi=
kipage?title=3DAssertionStatic&amp;referringTitle=3DAssertionActions">Execu=
ting</a> is particularly useful to test constructors, but when you have an=
 instance of a class, and you need to test a method call, you can use the=
 <b>Executing</b> extension.<br><br>For example, given a class like this<br=
><div style=3D"color:Black;background-color:White;"><pre>		<span style=3D"c=
olor:Blue;">private</span> <span style=3D"color:Blue;">class</span> MyClass
		{
			<span style=3D"color:Blue;">public</span> <span style=3D"color:Blue;">vo=
id</span> Method(<span style=3D"color:Blue;">string</span> value)
			{
				<span style=3D"color:Blue;">if</span> (value =3D=3D <span style=3D"colo=
r:Blue;">null</span>)
				{
					<span style=3D"color:Blue;">throw</span> <span style=3D"color:Blue;">n=
ew</span> ArgumentNullException(<span style=3D"color:#A31515;">&quot;value&=
quot;</span>,<span style=3D"color:#A31515;">&quot;My message&quot;</span>);
				}
			}
		}
</pre></div>you can test the behaviour of the method with:<br><div style=3D=
"color:Black;background-color:White;"><pre>			<span style=3D"color:Blue;">v=
ar</span> actual =3D <span style=3D"color:Blue;">new</span> MyClass();
			actual.Executing(a =3D&gt; a.Method(<span style=3D"color:Blue;">null</sp=
an>)).Throws&lt;ArgumentNullException&gt;();
			actual.Executing(a =3D&gt; a.Method(<span style=3D"color:Blue;">null</sp=
an>)).Throws();
			actual.Executing(a =3D&gt; a.Method(<span style=3D"color:#A31515;">&quot=
;somethig&quot;</span>)).NotThrows();
</pre></div>
<h4>Examples using <i>ExceptionExtensions</i> and LINQ</h4>
<b>Sharp Tests Ex</b> offer <a href=3D"http://sharptestex.codeplex.com/wiki=
page?title=3DExtensions&amp;referringTitle=3DAssertionActions&amp;ANCHOR#Ex=
ceptionExtensions">two additional useful extensions</a> to easy work with=
 the <span class=3D"codeInline">Exception</span> tree.<br><div style=3D"col=
or:Black;background-color:White;"><pre>		<span style=3D"color:Blue;">public=
</span> <span style=3D"color:Blue;">class</span> SillyClass
		{
			<span style=3D"color:Blue;">public</span> SillyClass(<span style=3D"colo=
r:Blue;">object</span> obj)
			{
				<span style=3D"color:Blue;">if</span> (obj =3D=3D <span style=3D"color:=
Blue;">null</span>)
				{
					<span style=3D"color:Blue;">throw</span> <span style=3D"color:Blue;">n=
ew</span> ArgumentException(<span style=3D"color:#A31515;">&quot;mess&quot;=
</span>,
							<span style=3D"color:Blue;">new</span> ArgumentNullException(<span=
 style=3D"color:#A31515;">&quot;mess null&quot;</span>,
								<span style=3D"color:Blue;">new</span> ArgumentOutOfRangeException(=
<span style=3D"color:#A31515;">&quot;obj&quot;</span>)));
				}
			}
		}

		[TestMethod]
		<span style=3D"color:Blue;">public</span> <span style=3D"color:Blue;">voi=
d</span> Example()
		{
			(<span style=3D"color:Blue;">new</span> Action(() =3D&gt; <span style=3D=
"color:Blue;">new</span> SillyClass(<span style=3D"color:Blue;">null</span>=
)))
							.Should().Throw&lt;ArgumentException&gt;()
							.And.ValueOf.InnerExceptions()
									.OfType&lt;ArgumentOutOfRangeException&gt;().First()
									.ParamName.Should().Be.EqualTo(<span style=3D"color:#A31515;">&quo=
t;obj&quot;</span>);

			(<span style=3D"color:Blue;">new</span> Action(() =3D&gt; <span style=3D=
"color:Blue;">new</span> SillyClass(<span style=3D"color:Blue;">null</span>=
)))
							.Should().Throw&lt;ArgumentException&gt;()
							.And.ValueOf.InnerExceptions().Select(e =3D&gt; e.GetType())
										.Should().Contain(<span style=3D"color:Blue;">typeof</span>(Argum=
entOutOfRangeException));

			(<span style=3D"color:Blue;">new</span> Action(() =3D&gt; <span style=3D=
"color:Blue;">new</span> SillyClass(<span style=3D"color:Blue;">null</span>=
)))
							.Should().Throw&lt;ArgumentException&gt;()
							.And.ValueOf.InnerException
									.Should().Be.OfType&lt;ArgumentNullException&gt;()
									.And.ValueOf.Message.Should().Be.EqualTo(<span style=3D"color:#A31=
515;">&quot;mess null&quot;</span>);
		}
</pre></div></div><div class=3D"ClearBoth"></div>
            </div>
       =20
            <div class=3D"wikiSource WikiInfo" id=3D"WikiInfo">
               =20
                    <div id=3D"editedInfoPanel">
                        <span class=3D"SubText">
                            Last edited <span localtimeticks=3D"1271222351"=
 class=3D"smartDate">Apr 13 2010 at 10:19 PM</span>&nbsp;by&nbsp;<a href=3D=
"http://www.codeplex.com/site/users/view/fabiomaulo" id=3D"wikiEditByLink">=
fabiomaulo</a>, version 7
                        </span></div></div></div></div></td></tr></tbody></=
table></div></div></td></tr></tbody></table></div></div></div></div></td></=
tr></tbody></table></form><div style=3D"font-size: 0.8em; clear: both; marg=
in-top: 2em; border: 1px solid black; background-color: white; color: black=
; padding: 0.5em; text-align: center;">Saved from <a class=3D"unmht_link_to=
_original" style=3D"color: blue; background-color: inherit; text-decoration=
: underline;" href=3D"http://sharptestex.codeplex.com/wikipage?title=3DAsse=
rtionActions&amp;referringTitle=3DDocumentation">http://sharptestex.codeple=
x.com/wikipage?title=3DAssertionActions&amp;referringTitle=3DDocumentation<=
/a></div></body></html>
------=_NextPart_000_0000_A5779167.B5ED4A03--
